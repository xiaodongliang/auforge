define("googleMap",["lodash","coreUtils","santa-components","componentsCore","skins","reactDOM","components"],function(e,t,n,a,o,i,r){return function(e){var t={};function n(a){if(t[a])return t[a].exports;var o=t[a]={i:a,l:!1,exports:{}};return e[a].call(o.exports,o,o.exports,n),o.l=!0,o.exports}return n.m=e,n.c=t,n.d=function(e,t,a){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:a})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var a=Object.create(null);if(n.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(a,o,function(t){return e[t]}.bind(null,o));return a},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=760)}({0:function(t,n){t.exports=e},1:function(e,n){e.exports=t},18:function(e,t){e.exports=r},2:function(e,t){e.exports=n},3:function(e,t){e.exports=a},5:function(e,t){e.exports=o},7:function(e,t){e.exports=i},760:function(e,t,n){var a,o;a=[n(2),n(0),n(1),n(7),n(18),n(5),n(761),n(3)],void 0===(o=function(e,t,n,a,o,i,r,s){"use strict";var p=["da","de","en","es","fr","it","ja","ko","nl","no","pl","pt","ru","sv","tr"],d=14,u={pt:"pt-BR"},l=function(e){var n=e.compProp.language,a=e.userLanguage,o="userLang"===n?a:n,i=t.includes(p,o)?o:"en";return u[i]||i};function c(e){return n.googleMapUtils.getGoogleMapsData(e)}function f(e,n){if(!t.get(n,"data.locations"))return{zoom:d,center:{}};var a=t.get(e,["zoom"],n.props.zoom||d),o=n.data.locations[n.data.defaultLocation]||{};return{zoom:a,center:t.get(e,["center"],{longitude:o.longitude,latitude:o.latitude})}}var m={displayName:"GoogleMap",mixins:[s.mixins.skinBasedComp,e.mixins.compStateMixin(f)],statics:{compSpecificIsDomOnlyOverride:function(){return!1},behaviors:{getVisibleMarkers:{methodName:"getVisibleMarkers"},setMapZoom:{methodName:"setMapZoom",params:["zoom"]},setMapCenter:{methodName:"setMapCenter",params:["longitude","latitude"]}}},propTypes:{compData:e.santaTypesDefinitions.Component.compData.isRequired,compProp:e.santaTypesDefinitions.Component.compProp.isRequired,structure:e.santaTypesDefinitions.Component.structure.isRequired,santaBase:e.santaTypesDefinitions.santaBase.isRequired,cannotHideIframeWithinRoundedCorners:e.santaTypesDefinitions.mobile.cannotHideIframeWithinRoundedCorners.isRequired,userLanguage:e.santaTypesDefinitions.WixUserSantaTypes.userLanguage.isRequired,componentPreviewState:e.santaTypesDefinitions.RenderFlags.componentPreviewState,isPreviewMode:e.santaTypesDefinitions.isPreviewMode.isRequired,componentViewMode:e.santaTypesDefinitions.RenderFlags.componentViewMode,isExperimentOpen:e.santaTypesDefinitions.isExperimentOpen,getExperimentValue:e.santaTypesDefinitions.getExperimentValue,locations:e.santaTypesDefinitions.GoogleMap.locations},getInitialState:function(){var e={};return this.props.cannotHideIframeWithinRoundedCorners()&&(e.$corners="squared"),this.restartMap(this.props),t.assign(f(null,{props:this.props.compProp,data:this.props.compData}),e)},componentDidMount:function(){this.iFrameNode=a.findDOMNode(this.refs.iframe),this.iFrameNode.onload=function(){window.addEventListener("message",this.googleMapsMessageHandler);var e=c(this.props);this.iFrameNode.contentWindow.postMessage({type:"SET_INITIAL_LOCATIONS",data:JSON.stringify(e)},"*")}.bind(this)},googleMapsMessageHandler:function(e){try{var t=JSON.parse(e.data);"MAP_CLICKED"===t.type?this.onMapClicked(t.data):"MARKER_CLICKED"===t.type?this.onMarkerClicked(t.data):"ZOOM_UPDATED"===t.type?this.zoomChanged(t.data):"CENTER_UPDATED"===t.type&&this.centerChanged(t.data)}catch(e){return}},componentWillUnmount:function(){window.removeEventListener("message",this.googleMapsMessageHandler)},setMapZoom:function(e,t){var n=this;this.setState({zoom:e}),new Promise(function(t){window.addEventListener("message",function(e){try{"SET_ZOOM_FINISHED"===JSON.parse(e.data).type&&t()}catch(e){return}}),a.findDOMNode(n.refs.iframe).contentWindow.postMessage({type:"SET_ZOOM",data:e},"*")}).then(function(){t()})},setMapCenter:function(e,t,n){var o=this;this.setState({center:{longitude:e,latitude:t}}),new Promise(function(n){window.addEventListener("message",function(e){try{var t=JSON.parse(e.data);"SET_CENTER_FINISHED"===t.type&&n(t.data)}catch(e){return}}),a.findDOMNode(o.refs.iframe).contentWindow.postMessage({type:"SET_CENTER",data:JSON.stringify({longitude:e,latitude:t})},"*")}).then(function(){n()})},centerChanged:function(e){this.setState({center:e})},zoomChanged:function(e){this.setState({zoom:e})},getVisibleMarkers:function(e){var t=this;new Promise(function(e){window.addEventListener("message",function(t){try{var n=JSON.parse(t.data);"MARKERS"===n.type&&e(n.data)}catch(e){return}}),a.findDOMNode(t.refs.iframe).contentWindow.postMessage({type:"GET_MARKERS"},"*")}).then(function(t){e(t)})},onMapClicked:function(e){this.handleAction(n.siteConstants.ACTION_TYPES.GOOGLE_MAP_CLICKED,e)},onMarkerClicked:function(e){e=t.assign(e,t.pick(e.location,["longitude","latitude"])),this.handleAction(n.siteConstants.ACTION_TYPES.GOOGLE_MAP_MARKER_CLICKED,e)},componentWillReceiveProps:function(e){var n=c(e);if(!t.isEqual(this.currentMapProperties,n)){if(l(this.props)!==l(e))return void this.restartMap(e);this.currentMapProperties=n;var a=this.shouldKeepMarkers(e.compData.locations);this.updateMapParams(this.currentMapProperties,a)}},shouldKeepMarkers:function(e){return t.isEqual(this.props.compData.locations,e)},updateMapParams:function(e,n){a.findDOMNode(this.refs.iframe).contentWindow.postMessage(JSON.stringify(t.assign({},e,{shouldKeepMarkers:!!n})),"*")},restartMap:function(e){this.iframeUrl=function(e){var a=c(e),o=t.pick(a,["defaultLocation","showZoom","showStreetView","showMapType","fullscreenControl"]),i=t.reduce(o,function(e,t,n){return e.concat("&"+n+"="+t)},""),r=e.getExperimentValue("googleMapsClientKey"),s=r?"&clientKey="+r:"",p="language="+l(e)+i+s;return n.urlUtils.joinURL(e.santaBase||"","static/external/googleMap.html?"+p)}(e),this.a11yTitle=n.translationsLoader.getTranslation("component_label",l(e),"COMPONENT_LABEL_googleMapsTitle")},getSkinProperties:function(){return{"":{tabIndex:0,title:this.a11yTitle,"aria-label":this.a11yTitle},mapContainer:{key:"mapContainer",children:[e.utils.createReactElement("iframe",{ref:"iframe","data-src":this.iframeUrl,width:"100%",height:"100%",frameBorder:"0",allowFullScreen:!0,scrolling:"no",title:this.a11yTitle,"aria-label":this.a11yTitle})]}}}};return s.compRegistrar.register("wysiwyg.viewer.components.GoogleMap",m),o.translationRequirementsChecker.registerCommonLanguageRequirement("wysiwyg.viewer.components.GoogleMap",function(e,n){return t.get(n,["properties","language"])}),i.skinsMap.addBatch(r),m}.apply(t,a))||(e.exports=o)},761:function(e,t,n){var a,o,i;"undefined"!=typeof self&&self,o=[],void 0===(i="function"==typeof(a=function(){"use strict";var e={"wysiwyg.viewer.skins.GoogleMapSkin":{react:[["div","mapContainer",[],{}]],css:{'%[data-state~="squared"],%[data-state~="squared"] %mapContainer':"border-radius:0;","%mapContainer":"position:absolute;top:0;right:0;bottom:0;left:0;"}},"wysiwyg.viewer.skins.map.GoogleMapDefault":{react:[["div","mapContainer",[],{}]],params:{brd:"BG_COLOR_ALPHA",rd:"BORDER_RADIUS",shd:"BOX_SHADOW",brw:"SIZE"},paramsDefaults:{brd:"color_15",rd:"0",shd:"0 1px 4px rgba(0, 0, 0, 0.6)",brw:"0"},css:{'%[data-state~="squared"],%[data-state~="squared"] %mapContainer':"border-radius:0;","%":"background:[brd];[rd]  [shd]","%mapContainer":"display:inline-block;overflow:hidden;[rd]  position:absolute;top:[brw];right:[brw];bottom:[brw];left:[brw];-webkit-mask-image:-webkit-radial-gradient(circle, #fff, #000);mask-image:radial-gradient(circle, #fff, #000);"}},"wysiwyg.viewer.skins.map.GoogleMapLiftedShadow":{react:[["div",null,["_left","_shd"],{}],["div",null,["_right","_shd"],{}],["div","mapContainer",[],{}]],params:{tdr:"URL",brd:"BG_COLOR_ALPHA",rd:"BORDER_RADIUS",shd:"BOX_SHADOW",brw:"SIZE"},paramsDefaults:{tdr:"BASE_THEME_DIRECTORY",brd:"color_15",rd:"0",shd:"0 1px 4px rgba(0, 0, 0, 0.6)",brw:"0"},css:{'%[data-state~="squared"],%[data-state~="squared"] %mapContainer':"border-radius:0;","%_shd":"position:absolute;bottom:-26px;width:165px;height:26px;background-image:url([tdr]liftedshadow_medium.png);background-repeat:no-repeat;","%_left":"left:-20px;background-position:0 0;","%_right":"right:-20px;background-position:100% 0;","%":"background-color:[brd];[rd]  [shd]","%mapContainer":"position:absolute;top:[brw];right:[brw];bottom:[brw];left:[brw];overflow:hidden;"}},"wysiwyg.viewer.skins.map.GoogleMapSloppy":{react:[["div",null,["_brd","_one"],{}],["div",null,["_brd","_two"],{}],["div","mapContainer",[],{}]],params:{tdr:"URL"},paramsDefaults:{tdr:"BASE_THEME_DIRECTORY"},css:{'%[data-state~="squared"],%[data-state~="squared"] %mapContainer':"border-radius:0;","%_brd":"background-image:url([tdr]sloppyframe.png);background-repeat:no-repeat;position:absolute;top:0;right:0;bottom:0;left:0;","%_one":"background-position:0 0;bottom:3px;right:3px;","%_two":"background-position:100% 100%;top:3px;left:3px;","%mapContainer":"position:absolute;top:9px;bottom:9px;left:9px;right:9px;"}}};return e})?a.apply(t,o):a)||(e.exports=i)}})});
//# sourceMappingURL=googleMap.min.js.map